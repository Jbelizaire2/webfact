{% extends 'Main/base_test.html.twig' %}


{% block title %}MANTENEDOR{% endblock %}
{% block subtitle %}Imagen{% endblock %}

{% block body %}
<style type="text/css">
	#example td, th{
		text-align: center; 
    	vertical-align: middle;
	}
</style>
<legend><h3><label>Lista de Imagenes</label></h3></legend>
  <div style="text-align:right">
        <a type="button" class="btn btn-success" style="width:80px;" href="{{ path('accounting_image_addImagen') }}">
            <span class="fa fa-plus" aria-hidden="true"></span>
        </a>
		</div>


            <!-- /.box-header -->
<table id="example" class="table table-striped table-bordered"  style="table-layout: fixed; border-color: #fff">
												<thead>
													<tr>
													   <th>#</th>
														<th>Tit&uacute;lo</th>
														<th>Fecha Creaci&oacute;n</th>
														<th>Descripcion</th>
                                                        <th>Archivo</th>
														<th>Acci&oacute;n</th>
														<th style="text-align:center"></th>
														<th style="text-align:center"></th>
															</tr>
												</thead>
												<tbody>
													{% for d in imagenes %}


												 <tr data-id="{{ d.id }}"
		                                             data-titulo="{{ d.titulo }}"
		                                             data-created_at="{{ d.created_at| date('Y-m-d') }}"
	                                            	 data-descripcion="{{ d.descripcion | capitalize }}"
		                                             data-archivo="{{ d.archivo}}"
													 >
													
													
													   <td>{{ loop.index}}</td>
															<td>{{ d.titulo  }}</td>
															<td>{{ d.created_at | date('Y-m-d')  }}</td>
															<td>{{ d.descripcion|capitalize  }}</td>
															<td>
																{% if d.archivo %}
																<a type="button" class="btn btn-info" onClick="javascript:window.open('{{ asset('uploads/'~ d.archivo) }}','','width=600,height=400,left=50,top=50,toolbar=yes'); return false;"  href="">
																	<span class="fa fa-image" aria-hidden="true"></span>
																</a>	
																	{% endif %}
														</td>
														<td>
																<a type="button" class="btn btn-warning update" href="{{ path('accounting_imagen_editImagen', { 'id': d.id }) }}">
																			<span class="fa fa-pencil" aria-hidden="true"></span> 
																	</a>
														</td>
														      <td>
                                                <a type="button" class="btn btn-danger delete" href="{{ path('mantenedor_image_drop', { 'id': d.id }) }}">
                                                <span class="fa fa-trash" aria-hidden="true"></span>
                                                   </a>
                                                  </td>

													<td>
													 {% if is_granted('ROLE_ADMIN') %}
													{%  if (d.id_status == 1) %}
													<input id="toggle-event" type="checkbox" checked data-toggle="toggle" data-on="Por Aprobar" data-off="Inactivo" data-onstyle="success" data-offstyle="danger" onchange="toggleCheckbox({{d.id}},'3')" >
                                                    {% endif %}
												 {%  if (d.id_status == 2 ) %}

													 
                                                     <input id="toggle-event1" type="checkbox"   data-toggle="toggle" data-on="Por Aprobar" data-off="Eliminado" data-onstyle="success" data-offstyle="danger" onchange="toggleCheckbox({{d.id}},'2')" >
                                                    {% endif %}
												   {%  if (d.id_status == 3) %}
                                                     <input id="toggle-event1" type="checkbox" checked data-toggle="toggle" data-on="Aprobado" data-off="Inactivo" data-onstyle="warning" data-offstyle="warning" onchange="toggleCheckbox({{d.id}},'1')" >
                                                   {% endif %}                                                 
                                                
												   
												   {% endif %} 
													 </td>
                                                   	
													</tr>
													{% endfor %}
												</tbody>
											</table>
											   
            <!-- /.box-body -->

{% endblock %}
{% block javascripts %}
    <script>
    $(document).ready(function() {
    $('#example').DataTable({
    "language": {

	search: "Buscar:",
	"lengthMenu":     "Ver _MENU_ Entradas",
	"info":           "Demostración _START_ a _END_ de _TOTAL_ entradas",
	"zeroRecords":    "No se encontraron registros coincidentes",
	"infoEmpty":      "Mostrando 0 de 0 entradas",
	"infoFiltered":   "(Filtrado de _MAX_ entradas totales)",

    
    "paginate": {
       previous: "Atras",
	   next: "Siguiente"
	   
    }
  }

});


 
 });

 function toggleCheckbox(element, status)
 {
	console.log(element);
	const toast = swal.mixin({
		  toast: true,
		  position: 'top-end',
		  showConfirmButton: false,
		  timer: 3500
		});	
	let name="";
   if (status=='true'){
        name="Desaprobar";
     }else{
		 name="Aprobar";
	 }
	    //swal("Hola");

			 var url = '{{ path("mantenedor_image_status", {'id': 'id'}) }}'; 
                     url = url.replace("id", element);

					 swal({
			  title: '¿Esta Seguro(a) de '+ name +' la Imagen?',
			  text: "Imagenes Administracion",
			  type: 'warning',
			  showCancelButton: true,
			  confirmButtonColor: '#d58512',
			  cancelButtonColor: '#d33',
			  confirmButtonText: 'Si, '+ name +' Imagen!',
			  allowOutsideClick: false,
			  reverseButtons: true
			}).then((result) => {
				if (result.value) {
					$.ajax({
						url: url,
				        dataType: "json",
				        type: "POST",
				        data: {"id" : element, "status" : status}
					})
					.done(function(data) {
						//console.log(data);
						location.reload(true);
						
									toast({
							  type: 'success',
							  title: 'Imagen '+ name +' con Éxito!'
							})
						
						
					})

				}else{
					toast({
						type: 'info',
						title: 'Se ha Cancelado la Operación!'
					})
				}
			})
			
 }
</script>
{% endblock %}
